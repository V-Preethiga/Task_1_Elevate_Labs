CREATE DATABASE IF NOT EXISTS online_sales;
-- Query OK, 1 row affected (0.01 sec)

USE online_sales;
-- Database changed

CREATE TABLE orders_online (order_id INT PRIMARY KEY,order_date DATE NOT NULL,amount DECIMAL(10,2) NOT NULL, product_id INT NOT NULL
);

-- Query OK, 0 rows affected (0.11 sec)

LOAD DATA INFILE 'C:/ProgramData/MySQL/MySQL Server 8.0/Uploads/orders_online.csv' INTO TABLE orders_online FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '\n' IGNORE 1 ROWS
(order_id, @order_date, amount, product_id) SET order_date = STR_TO_DATE(@order_date, '%d-%m-%Y');



/* Query OK, 500 rows affected (0.06 sec)
Records: 500  Deleted: 0  Skipped: 0  Warnings: 0 */

SELECT * FROM orders_online;

/* +----------+------------+--------+------------+
| order_id | order_date | amount | product_id |
+----------+------------+--------+------------+
|        1 | 2024-05-28 |  98.63 |         15 |
|        2 | 2023-02-28 | 785.15 |         16 |
|        3 | 2023-03-10 | 998.92 |         26 |
|        4 | 2024-05-06 | 676.96 |         43 |
|        5 | 2023-08-27 | 415.80 |          6 |
|        6 | 2023-02-23 | 253.97 |         42 |
|        7 | 2024-11-24 |  33.22 |         23 |
|        8 | 2024-06-26 | 708.45 |         30 |
|        9 | 2024-09-17 | 966.58 |          6 |
|       10 | 2023-02-10 | 705.80 |         18 |
|       11 | 2024-04-20 |  65.88 |         22 |
|       12 | 2024-04-10 | 570.71 |         10 |
|       13 | 2024-09-13 |  44.61 |         31 |
|       14 | 2023-10-26 | 563.73 |          5 |
|       15 | 2024-06-27 | 268.82 |         18 |
|       16 | 2024-03-03 | 956.75 |         49 |
|       17 | 2024-02-16 | 875.62 |         42 |
|       18 | 2024-06-30 | 610.73 |         42 |
|       19 | 2024-01-18 | 992.58 |         41 |
|       20 | 2024-09-16 | 700.55 |         25 |
|       21 | 2023-07-31 | 808.92 |          4 |
|       22 | 2024-08-04 | 541.40 |         24 |
|       23 | 2024-11-01 | 771.10 |         43 |
|       24 | 2023-12-20 | 168.68 |         15 |
|       25 | 2023-04-25 |  83.43 |         16 |
|       26 | 2023-01-19 | 469.71 |         28 |
|       27 | 2024-03-17 | 162.24 |          1 |
|       28 | 2024-08-07 | 455.08 |         31 |
|       29 | 2024-09-08 |  17.62 |         17 |
|       30 | 2023-03-14 |  82.28 |         12 |
|       31 | 2023-05-07 |  15.98 |          4 |
|       32 | 2023-02-10 | 710.41 |          4 |
|       33 | 2024-06-29 | 590.83 |         41 |
|       34 | 2024-02-01 | 534.91 |         24 |
|       35 | 2024-11-02 |  80.64 |         50 |
|       36 | 2024-12-11 | 681.11 |         37 |
|       37 | 2023-08-12 | 456.62 |         18 |
|       38 | 2023-08-17 | 530.95 |         31 |
|       39 | 2024-02-29 | 664.65 |         49 |
|       40 | 2023-09-22 | 443.68 |         22 |
|       41 | 2024-03-04 | 569.99 |         42 |
|       42 | 2023-01-23 |  55.41 |          5 |
|       43 | 2023-02-19 | 984.95 |         47 |
|       44 | 2024-11-27 | 707.08 |         17 |
|       45 | 2024-01-01 | 604.79 |         19 |
|       46 | 2023-08-11 | 761.86 |         42 |
|       47 | 2023-12-15 | 636.35 |         31 |
|       48 | 2024-04-15 | 418.55 |         10 |
|       49 | 2024-10-31 | 628.25 |         40 |
|       50 | 2024-05-05 | 283.15 |         25 |
|       51 | 2023-03-15 | 888.26 |          8 |
|       52 | 2024-08-27 | 707.85 |         36 |
|       53 | 2023-04-09 | 103.05 |          7 |
|       54 | 2023-01-18 | 736.76 |         38 |
|       55 | 2023-04-30 | 963.78 |          4 |
|       56 | 2023-03-24 | 770.91 |         32 |
|       57 | 2024-04-12 | 195.04 |         25 |
|       58 | 2023-12-19 | 734.12 |         17 |
|       59 | 2023-02-05 | 559.39 |         28 |
|       60 | 2023-11-30 | 943.60 |         46 |
|       61 | 2024-04-21 | 154.10 |         10 |
|       62 | 2024-11-11 |  49.45 |         17 |
|       63 | 2024-12-17 | 548.22 |         21 |
|       64 | 2024-08-27 | 800.83 |         31 |
|       65 | 2024-07-22 | 714.51 |          9 |
|       66 | 2023-10-01 | 626.21 |         33 |
|       67 | 2023-07-11 | 913.15 |         21 |
|       68 | 2024-03-19 | 564.43 |         47 |
|       69 | 2023-05-30 |  59.81 |         49 |
|       70 | 2024-05-22 | 164.01 |          9 |
|       71 | 2024-02-09 | 839.10 |         26 |
|       72 | 2023-08-25 | 561.64 |         27 |
|       73 | 2024-08-26 | 372.63 |         11 |
|       74 | 2023-03-04 | 535.10 |         25 |
|       75 | 2024-04-05 | 129.29 |         19 |
|       76 | 2024-05-02 |  23.08 |         12 |
|       77 | 2023-06-26 | 394.98 |         11 |
|       78 | 2023-12-18 | 323.98 |          4 |
|       79 | 2023-03-22 |  72.98 |         37 |
|       80 | 2024-04-17 | 243.75 |          5 |
|       81 | 2024-08-15 | 736.59 |          2 |
|       82 | 2024-10-11 | 938.23 |         33 |
|       83 | 2024-03-22 | 226.64 |          1 |
|       84 | 2023-03-03 |  84.07 |         28 |
|       85 | 2024-01-05 | 123.03 |          6 |
|       86 | 2023-09-03 | 698.84 |          3 |
|       87 | 2023-02-27 | 407.94 |         26 |
|       88 | 2024-09-22 | 306.31 |          6 |
|       89 | 2023-02-21 | 527.40 |         33 |
|       90 | 2024-04-12 | 975.20 |         14 |
|       91 | 2023-11-11 | 360.32 |         40 |
|       92 | 2023-05-27 | 223.29 |         23 |
|       93 | 2023-10-19 | 198.57 |         22 |
|       94 | 2024-01-02 | 728.53 |          1 |
|       95 | 2023-02-02 | 400.67 |         44 |
|       96 | 2024-04-24 |  32.26 |         50 |
|       97 | 2024-08-06 | 916.00 |         42 |
|       98 | 2024-01-22 | 766.54 |         20 |
|       99 | 2023-03-01 | 467.90 |         47 |
|      100 | 2023-04-09 | 365.83 |         19 |
|      101 | 2024-04-30 | 268.13 |          5 |
|      102 | 2024-03-16 | 778.10 |          9 |
|      103 | 2023-09-16 | 591.13 |          5 |
|      104 | 2023-07-08 | 299.89 |          1 |
|      105 | 2023-07-08 | 681.75 |          1 |
|      106 | 2024-08-27 | 138.68 |         16 |
|      107 | 2023-11-18 | 190.75 |         15 |
|      108 | 2024-09-02 | 376.07 |         44 |
|      109 | 2023-01-08 | 599.35 |         25 |
|      110 | 2023-04-06 | 166.63 |         44 |
|      111 | 2023-12-05 | 633.20 |          3 |
|      112 | 2023-11-21 |  54.95 |         37 |
|      113 | 2023-03-10 | 193.79 |         39 |
|      114 | 2023-06-04 | 631.89 |         34 |
|      115 | 2023-05-27 | 285.52 |         39 |
|      116 | 2024-10-05 | 495.77 |          3 |
|      117 | 2023-01-05 | 383.65 |          4 |
|      118 | 2023-12-01 | 610.39 |         18 |
|      119 | 2023-04-12 | 809.29 |         18 |
|      120 | 2023-06-20 | 787.76 |         21 |
|      121 | 2023-11-11 | 507.21 |         21 |
|      122 | 2024-03-16 | 496.19 |         12 |
|      123 | 2023-11-23 | 133.63 |          2 |
|      124 | 2024-02-19 | 257.88 |          5 |
|      125 | 2023-07-04 | 576.41 |         27 |
|      126 | 2024-06-14 | 350.10 |          1 |
|      127 | 2024-01-19 |  84.13 |         11 |
|      128 | 2023-10-16 | 881.71 |         27 |
|      129 | 2024-06-06 | 748.97 |         16 |
|      130 | 2023-08-26 | 574.29 |         13 |
|      131 | 2023-08-27 | 672.71 |         34 |
|      132 | 2023-12-30 | 792.17 |         38 |
|      133 | 2024-12-29 | 612.00 |         13 |
|      134 | 2024-11-17 | 433.34 |         18 |
|      135 | 2024-08-25 |  87.55 |         24 |
|      136 | 2023-09-19 | 877.84 |         44 |
|      137 | 2024-04-03 | 891.68 |         28 |
|      138 | 2024-03-09 | 252.62 |         14 |
|      139 | 2023-05-05 | 719.21 |         13 |
|      140 | 2023-09-30 | 431.22 |         18 |
|      141 | 2024-04-22 | 358.30 |          6 |
|      142 | 2023-07-14 | 737.51 |         24 |
|      143 | 2024-08-24 | 694.68 |         48 |
|      144 | 2024-10-27 | 173.53 |         22 |
|      145 | 2023-04-21 | 353.10 |          4 |
|      146 | 2023-06-17 | 135.97 |         35 |
|      147 | 2023-11-11 | 164.57 |         41 |
|      148 | 2023-04-14 | 510.55 |         45 |
|      149 | 2023-12-24 | 879.45 |         46 |
|      150 | 2024-06-05 | 389.78 |         35 |
|      151 | 2023-01-11 | 321.05 |         35 |
|      152 | 2023-07-28 | 229.43 |          1 |
|      153 | 2023-06-15 | 771.70 |         31 |
|      154 | 2024-12-21 | 819.92 |         26 |
|      155 | 2024-01-14 | 894.93 |         11 |
|      156 | 2023-05-31 | 286.38 |         42 |
|      157 | 2024-11-14 | 864.22 |         37 |
|      158 | 2023-10-17 | 432.08 |         48 |
|      159 | 2024-05-18 | 656.08 |         45 |
|      160 | 2024-11-19 | 439.98 |          4 |
|      161 | 2023-12-13 | 405.23 |         14 |
|      162 | 2024-12-03 | 696.93 |         35 |
|      163 | 2023-03-12 | 400.80 |         41 |
|      164 | 2023-02-11 | 605.84 |          7 |
|      165 | 2024-11-27 | 366.64 |         35 |
|      166 | 2024-01-20 | 216.58 |         14 |
|      167 | 2023-12-09 | 376.11 |         27 |
|      168 | 2023-03-30 |  77.79 |         22 |
|      169 | 2023-04-20 | 709.35 |         17 |
|      170 | 2024-12-22 | 212.37 |         37 |
|      171 | 2024-02-10 | 385.63 |         18 |
|      172 | 2024-02-23 | 521.33 |          1 |
|      173 | 2024-11-23 | 344.11 |         10 |
|      174 | 2023-05-19 | 704.27 |          8 |
|      175 | 2023-02-25 |  61.88 |         29 |
|      176 | 2023-10-08 | 483.28 |         14 |
|      177 | 2024-05-26 | 257.78 |         20 |
|      178 | 2024-12-16 | 401.60 |         26 |
|      179 | 2024-06-10 | 955.05 |         48 |
|      180 | 2024-04-07 | 771.82 |         39 |
|      181 | 2023-10-26 |  26.14 |          6 |
|      182 | 2024-09-21 | 424.05 |         47 |
|      183 | 2024-05-27 | 108.61 |         42 |
|      184 | 2024-02-19 | 758.06 |         33 |
|      185 | 2023-04-18 | 750.79 |          2 |
|      186 | 2024-02-08 | 531.79 |         43 |
|      187 | 2024-01-28 | 259.28 |         46 |
|      188 | 2023-10-25 | 310.11 |          6 |
|      189 | 2023-09-01 | 223.21 |         48 |
|      190 | 2023-06-14 | 170.96 |          6 |
|      191 | 2023-03-24 | 224.26 |         11 |
|      192 | 2023-11-19 | 694.29 |          6 |
|      193 | 2024-06-01 | 576.36 |         40 |
|      194 | 2023-11-30 | 105.17 |          4 |
|      195 | 2024-01-03 |  44.89 |         13 |
|      196 | 2024-08-11 | 827.29 |          2 |
|      197 | 2023-08-17 | 948.30 |         29 |
|      198 | 2023-01-09 | 872.15 |         22 |
|      199 | 2024-12-27 | 196.21 |         38 |
|      200 | 2024-11-14 | 574.03 |          6 |
|      201 | 2023-12-06 | 480.08 |         26 |
|      202 | 2024-10-20 | 575.73 |         37 |
|      203 | 2023-07-23 | 133.36 |          4 |
|      204 | 2024-04-09 | 436.11 |         45 |
|      205 | 2023-09-17 | 284.45 |         33 |
|      206 | 2023-11-20 | 728.98 |         17 |
|      207 | 2024-09-21 | 302.90 |         19 |
|      208 | 2023-08-03 | 978.11 |         28 |
|      209 | 2023-01-26 | 697.97 |         25 |
|      210 | 2023-09-15 | 398.29 |          3 |
|      211 | 2024-04-07 | 817.49 |         11 |
|      212 | 2024-09-27 | 264.17 |          4 |
|      213 | 2024-04-20 | 806.87 |         15 |
|      214 | 2023-08-25 | 114.90 |         37 |
|      215 | 2023-02-24 |  68.10 |         18 |
|      216 | 2023-08-12 | 657.42 |         47 |
|      217 | 2023-09-26 | 777.47 |         19 |
|      218 | 2024-09-26 | 428.32 |         20 |
|      219 | 2024-01-25 | 227.63 |         19 |
|      220 | 2024-01-06 | 114.79 |         50 |
|      221 | 2024-12-29 | 190.21 |         47 |
|      222 | 2024-07-13 | 922.43 |         43 |
|      223 | 2024-03-20 | 748.77 |         42 |
|      224 | 2024-04-04 | 605.06 |         15 |
|      225 | 2023-09-02 | 504.07 |         43 |
|      226 | 2023-05-05 | 186.26 |         49 |
|      227 | 2023-06-12 |  70.00 |          7 |
|      228 | 2024-02-17 | 970.94 |         30 |
|      229 | 2024-02-28 | 222.52 |         11 |
|      230 | 2023-07-04 | 916.28 |         44 |
|      231 | 2024-01-22 | 825.30 |         15 |
|      232 | 2024-12-07 | 724.60 |         14 |
|      233 | 2023-09-21 | 824.25 |         48 |
|      234 | 2024-05-10 | 787.85 |         49 |
|      235 | 2023-04-16 | 359.00 |         29 |
|      236 | 2023-12-21 | 989.66 |          7 |
|      237 | 2024-08-23 | 166.27 |         19 |
|      238 | 2023-05-15 | 235.99 |         39 |
|      239 | 2024-01-15 | 458.26 |         27 |
|      240 | 2023-03-28 | 966.43 |          4 |
|      241 | 2024-06-30 | 343.43 |          9 |
|      242 | 2023-02-02 | 360.44 |         36 |
|      243 | 2023-03-01 | 239.37 |          8 |
|      244 | 2023-10-06 | 577.94 |         16 |
|      245 | 2024-06-03 |  46.32 |          1 |
|      246 | 2024-08-20 |  66.05 |         32 |
|      247 | 2023-04-09 |  22.86 |         34 |
|      248 | 2023-03-14 | 549.65 |         27 |
|      249 | 2023-12-27 | 971.04 |         39 |
|      250 | 2024-11-26 | 344.66 |         43 |
|      251 | 2023-02-19 | 600.93 |         44 |
|      252 | 2024-01-19 | 691.62 |          6 |
|      253 | 2024-01-29 | 716.07 |         50 |
|      254 | 2024-07-22 | 297.53 |         38 |
|      255 | 2024-09-07 | 169.74 |         37 |
|      256 | 2024-05-11 | 153.47 |         11 |
|      257 | 2024-10-23 | 557.07 |         50 |
|      258 | 2023-03-28 | 217.88 |         33 |
|      259 | 2023-08-24 | 749.78 |         49 |
|      260 | 2023-06-23 | 801.32 |         43 |
|      261 | 2023-08-07 | 855.07 |          5 |
|      262 | 2024-05-05 | 245.64 |         12 |
|      263 | 2023-05-23 |  59.08 |         36 |
|      264 | 2023-01-14 | 708.35 |          9 |
|      265 | 2024-06-04 | 849.37 |         23 |
|      266 | 2023-11-26 |  88.58 |         20 |
|      267 | 2023-10-02 | 504.42 |         38 |
|      268 | 2024-11-22 | 584.40 |         34 |
|      269 | 2023-11-16 | 168.81 |         25 |
|      270 | 2024-06-13 | 788.18 |         49 |
|      271 | 2024-02-04 | 238.78 |         31 |
|      272 | 2023-11-30 | 903.65 |         17 |
|      273 | 2023-11-10 | 265.53 |         46 |
|      274 | 2023-10-23 | 858.86 |         16 |
|      275 | 2023-07-17 | 270.56 |         42 |
|      276 | 2024-08-11 | 353.15 |         31 |
|      277 | 2023-10-11 | 362.67 |          6 |
|      278 | 2023-02-11 |  60.96 |         15 |
|      279 | 2023-01-28 |  71.15 |          4 |
|      280 | 2023-03-08 |  43.73 |         22 |
|      281 | 2023-06-02 | 579.11 |         44 |
|      282 | 2023-11-17 | 571.30 |         34 |
|      283 | 2023-06-06 | 917.43 |          1 |
|      284 | 2023-08-16 | 633.76 |         13 |
|      285 | 2023-07-30 | 713.82 |         14 |
|      286 | 2023-02-28 | 577.94 |          6 |
|      287 | 2023-08-27 |  76.68 |         41 |
|      288 | 2023-03-11 | 642.09 |         42 |
|      289 | 2024-03-12 | 484.73 |         18 |
|      290 | 2024-04-04 | 682.97 |         41 |
|      291 | 2024-05-22 | 437.26 |         33 |
|      292 | 2023-12-06 | 742.92 |         31 |
|      293 | 2024-08-11 | 585.35 |          6 |
|      294 | 2023-04-13 | 524.33 |         39 |
|      295 | 2023-05-26 | 852.43 |          5 |
|      296 | 2023-08-04 | 415.31 |          9 |
|      297 | 2024-02-08 | 417.75 |         30 |
|      298 | 2024-10-01 | 993.16 |         19 |
|      299 | 2023-06-19 | 979.77 |         29 |
|      300 | 2024-07-05 | 990.32 |         49 |
|      301 | 2023-09-29 | 339.40 |         48 |
|      302 | 2024-05-01 | 668.84 |         34 |
|      303 | 2024-09-26 | 726.66 |         16 |
|      304 | 2023-08-13 |  77.99 |          4 |
|      305 | 2024-01-09 | 977.64 |          4 |
|      306 | 2023-12-06 | 768.41 |          9 |
|      307 | 2024-01-15 | 227.92 |         15 |
|      308 | 2024-06-19 | 679.13 |         23 |
|      309 | 2023-03-29 | 523.81 |         34 |
|      310 | 2024-11-20 | 261.43 |         25 |
|      311 | 2024-10-15 | 679.25 |         21 |
|      312 | 2024-08-02 | 788.82 |         43 |
|      313 | 2023-10-25 | 548.70 |         22 |
|      314 | 2023-09-02 |  59.39 |         23 |
|      315 | 2024-10-03 | 227.95 |         11 |
|      316 | 2024-06-17 | 694.46 |          1 |
|      317 | 2024-08-13 | 642.80 |         10 |
|      318 | 2023-11-18 | 898.37 |         18 |
|      319 | 2023-12-15 | 177.77 |         19 |
|      320 | 2023-04-14 | 807.45 |         18 |
|      321 | 2023-07-07 | 370.48 |         17 |
|      322 | 2023-09-15 | 121.77 |         21 |
|      323 | 2024-09-24 | 924.22 |         36 |
|      324 | 2023-09-05 | 108.95 |         50 |
|      325 | 2024-01-19 | 359.77 |          1 |
|      326 | 2024-01-22 | 766.39 |         15 |
|      327 | 2023-02-12 | 931.39 |         27 |
|      328 | 2024-06-05 | 440.05 |         50 |
|      329 | 2024-07-16 | 882.50 |         20 |
|      330 | 2024-08-27 | 756.78 |         39 |
|      331 | 2023-04-27 | 629.12 |         20 |
|      332 | 2024-09-21 | 521.09 |         38 |
|      333 | 2023-03-15 | 560.00 |          8 |
|      334 | 2024-07-02 |  39.05 |         18 |
|      335 | 2023-11-14 | 252.12 |          4 |
|      336 | 2024-04-07 | 975.30 |         14 |
|      337 | 2024-10-01 | 168.93 |         49 |
|      338 | 2024-12-04 |  81.07 |         34 |
|      339 | 2024-02-01 | 611.15 |         47 |
|      340 | 2023-04-29 | 631.24 |         32 |
|      341 | 2023-08-01 | 448.68 |         13 |
|      342 | 2023-03-11 | 815.68 |         13 |
|      343 | 2023-03-18 | 361.09 |          3 |
|      344 | 2023-10-22 | 405.26 |         22 |
|      345 | 2023-05-20 | 663.20 |          1 |
|      346 | 2023-11-16 | 295.94 |         50 |
|      347 | 2024-02-10 | 792.10 |         14 |
|      348 | 2023-08-16 | 628.33 |         23 |
|      349 | 2023-05-03 | 739.61 |         12 |
|      350 | 2023-11-06 | 581.76 |         10 |
|      351 | 2024-12-21 | 749.10 |         40 |
|      352 | 2023-01-06 | 525.24 |         42 |
|      353 | 2024-02-22 | 634.98 |         14 |
|      354 | 2024-08-14 | 970.56 |          7 |
|      355 | 2024-03-24 |  60.03 |          1 |
|      356 | 2023-12-12 | 764.83 |         20 |
|      357 | 2024-03-15 |  17.08 |         39 |
|      358 | 2024-11-30 | 538.74 |         29 |
|      359 | 2024-04-01 | 137.23 |          8 |
|      360 | 2023-02-17 | 867.57 |         13 |
|      361 | 2024-10-28 | 692.35 |          1 |
|      362 | 2023-04-05 | 754.82 |         21 |
|      363 | 2024-05-08 | 653.45 |         29 |
|      364 | 2024-04-03 | 251.40 |         43 |
|      365 | 2023-07-19 |  53.03 |         27 |
|      366 | 2023-06-20 | 257.43 |          5 |
|      367 | 2023-11-12 | 127.25 |         15 |
|      368 | 2024-06-13 | 187.54 |         16 |
|      369 | 2024-06-26 | 388.25 |         41 |
|      370 | 2023-05-14 | 754.38 |         28 |
|      371 | 2024-09-30 | 583.76 |         27 |
|      372 | 2024-11-14 | 622.54 |         38 |
|      373 | 2024-03-05 | 640.14 |          5 |
|      374 | 2023-10-19 | 673.13 |         39 |
|      375 | 2023-09-08 | 544.61 |         27 |
|      376 | 2024-12-06 | 347.28 |         39 |
|      377 | 2024-12-02 | 422.59 |         46 |
|      378 | 2024-11-05 | 214.87 |         10 |
|      379 | 2023-08-31 | 436.16 |         27 |
|      380 | 2024-11-19 | 215.00 |         43 |
|      381 | 2024-01-29 | 177.51 |         33 |
|      382 | 2023-04-01 | 541.60 |         49 |
|      383 | 2024-08-08 | 586.95 |         30 |
|      384 | 2024-05-08 | 138.84 |         50 |
|      385 | 2024-12-17 | 189.49 |          9 |
|      386 | 2023-01-20 | 386.86 |          4 |
|      387 | 2023-07-31 | 948.61 |         32 |
|      388 | 2024-07-03 | 811.40 |          1 |
|      389 | 2024-03-08 | 291.57 |         28 |
|      390 | 2023-01-17 | 253.12 |         43 |
|      391 | 2023-07-18 | 300.46 |         10 |
|      392 | 2024-10-24 | 822.64 |         23 |
|      393 | 2024-05-25 | 412.70 |         35 |
|      394 | 2023-08-22 | 621.68 |         35 |
|      395 | 2024-05-05 | 727.72 |         44 |
|      396 | 2024-09-08 | 779.85 |          4 |
|      397 | 2024-06-29 | 626.94 |         19 |
|      398 | 2023-02-21 | 899.82 |          1 |
|      399 | 2023-09-24 | 900.49 |         31 |
|      400 | 2023-04-28 | 734.59 |         40 |
|      401 | 2024-05-14 | 210.96 |         29 |
|      402 | 2023-01-10 |  87.60 |         30 |
|      403 | 2024-11-15 |  22.05 |         19 |
|      404 | 2023-08-10 | 342.84 |         37 |
|      405 | 2023-04-04 | 140.00 |         20 |
|      406 | 2023-07-17 | 687.16 |         14 |
|      407 | 2024-06-24 | 171.15 |          9 |
|      408 | 2024-03-29 | 613.68 |         35 |
|      409 | 2024-04-28 | 146.76 |          9 |
|      410 | 2023-12-31 | 832.56 |         25 |
|      411 | 2023-07-08 |  59.70 |         36 |
|      412 | 2024-06-28 | 491.98 |         26 |
|      413 | 2024-06-02 | 803.73 |         28 |
|      414 | 2024-08-23 |  97.61 |         30 |
|      415 | 2024-01-19 | 983.71 |         16 |
|      416 | 2024-07-31 | 215.01 |         12 |
|      417 | 2024-10-28 | 768.56 |         10 |
|      418 | 2023-07-22 | 173.08 |         41 |
|      419 | 2024-02-02 | 113.94 |         11 |
|      420 | 2024-06-24 | 567.33 |         18 |
|      421 | 2024-04-11 | 375.06 |         39 |
|      422 | 2023-11-26 | 308.32 |         34 |
|      423 | 2023-04-22 | 281.40 |          4 |
|      424 | 2024-02-04 | 437.66 |         34 |
|      425 | 2023-11-13 |  11.96 |         36 |
|      426 | 2024-07-07 | 879.11 |         14 |
|      427 | 2023-03-01 | 149.67 |         20 |
|      428 | 2024-12-15 | 422.38 |         10 |
|      429 | 2023-10-06 |  49.12 |          9 |
|      430 | 2023-09-08 | 350.97 |         29 |
|      431 | 2023-01-23 | 578.20 |          1 |
|      432 | 2023-11-10 | 389.04 |         20 |
|      433 | 2023-10-25 | 738.45 |         40 |
|      434 | 2024-05-24 | 279.89 |         45 |
|      435 | 2023-09-18 | 249.81 |         40 |
|      436 | 2023-12-29 | 376.98 |         42 |
|      437 | 2023-06-04 | 593.80 |         40 |
|      438 | 2024-12-01 | 813.19 |          4 |
|      439 | 2023-03-27 | 146.44 |         43 |
|      440 | 2023-12-31 | 266.79 |         13 |
|      441 | 2023-01-28 | 493.02 |         42 |
|      442 | 2024-06-07 | 830.91 |          4 |
|      443 | 2023-02-06 |  71.48 |         47 |
|      444 | 2023-07-11 | 978.40 |         15 |
|      445 | 2024-09-10 | 560.45 |          8 |
|      446 | 2023-07-24 | 967.29 |         43 |
|      447 | 2024-07-28 | 893.12 |         12 |
|      448 | 2024-09-06 | 415.08 |         22 |
|      449 | 2023-05-29 | 548.03 |         29 |
|      450 | 2024-06-26 | 107.28 |         22 |
|      451 | 2023-04-11 | 926.80 |         27 |
|      452 | 2023-09-08 | 472.53 |         19 |
|      453 | 2024-08-02 | 341.43 |          2 |
|      454 | 2023-03-06 | 163.97 |          8 |
|      455 | 2024-07-01 | 356.21 |         13 |
|      456 | 2024-08-03 | 129.98 |         31 |
|      457 | 2024-05-09 | 209.50 |         33 |
|      458 | 2023-05-18 | 126.83 |         15 |
|      459 | 2024-11-02 | 559.81 |          3 |
|      460 | 2024-01-29 | 834.19 |         46 |
|      461 | 2024-10-26 | 406.41 |         14 |
|      462 | 2024-08-31 | 985.43 |          3 |
|      463 | 2023-01-08 | 817.14 |         29 |
|      464 | 2023-04-06 | 595.93 |         25 |
|      465 | 2024-01-06 | 818.42 |          3 |
|      466 | 2024-11-18 | 172.18 |         19 |
|      467 | 2023-05-01 | 308.47 |          9 |
|      468 | 2024-08-07 |  87.40 |         17 |
|      469 | 2024-07-14 |  96.79 |         24 |
|      470 | 2023-06-26 | 738.95 |         41 |
|      471 | 2024-05-07 | 681.47 |         16 |
|      472 | 2023-02-06 | 462.94 |         15 |
|      473 | 2023-03-19 | 386.52 |         40 |
|      474 | 2024-07-21 | 416.67 |          1 |
|      475 | 2024-11-22 | 539.09 |         42 |
|      476 | 2023-02-07 | 227.81 |         27 |
|      477 | 2023-04-11 | 871.95 |         47 |
|      478 | 2024-10-26 | 921.79 |         10 |
|      479 | 2024-04-19 | 926.06 |         48 |
|      480 | 2023-02-23 | 420.36 |         38 |
|      481 | 2024-09-14 | 410.60 |          4 |
|      482 | 2024-01-07 | 356.34 |         16 |
|      483 | 2023-05-02 | 327.44 |         16 |
|      484 | 2023-10-15 | 851.79 |          9 |
|      485 | 2023-09-23 | 104.49 |         36 |
|      486 | 2023-10-25 |  96.42 |         30 |
|      487 | 2023-05-31 | 549.12 |         47 |
|      488 | 2023-05-25 | 370.70 |         23 |
|      489 | 2023-12-29 | 451.34 |         26 |
|      490 | 2023-12-31 | 413.66 |          7 |
|      491 | 2024-08-14 | 807.23 |         49 |
|      492 | 2023-03-01 | 810.87 |          5 |
|      493 | 2024-11-12 | 855.67 |         22 |
|      494 | 2023-08-19 | 420.45 |          8 |
|      495 | 2023-05-02 |  57.93 |         22 |
|      496 | 2024-06-11 | 617.36 |         31 |
|      497 | 2024-06-23 | 642.10 |         15 |
|      498 | 2024-01-18 | 164.31 |          8 |
|      499 | 2023-04-17 | 100.06 |         26 |
|      500 | 2024-03-21 | 865.68 |         48 |
+----------+------------+--------+------------+
500 rows in set (0.00 sec) */

-- 1. Extract month from order_date

SELECT EXTRACT(MONTH FROM order_date) AS month, order_id, amount
FROM orders_onlineLIMIT 10;

/* +-------+----------+--------+
| month | order_id | amount |
+-------+----------+--------+
|     5 |        1 |  98.63 |
|     2 |        2 | 785.15 |
|     3 |        3 | 998.92 |
|     5 |        4 | 676.96 |
|     8 |        5 | 415.80 |
|     2 |        6 | 253.97 |
|    11 |        7 |  33.22 |
|     6 |        8 | 708.45 |
|     9 |        9 | 966.58 |
|     2 |       10 | 705.80 |
+-------+----------+--------+
10 rows in set (0.00 sec) */

-- 2. Group by year/month

SELECT YEAR(order_date) AS year, MONTH(order_date) AS month, COUNT(*) AS total_orders FROM orders_online GROUP BY year, month ORDER BY year, month;

/* +------+-------+--------------+
| year | month | total_orders |
+------+-------+--------------+
| 2023 |     1 |           17 |
| 2023 |     2 |           23 |
| 2023 |     3 |           27 |
| 2023 |     4 |           25 |
| 2023 |     5 |           21 |
| 2023 |     6 |           14 |
| 2023 |     7 |           20 |
| 2023 |     8 |           23 |
| 2023 |     9 |           21 |
| 2023 |    10 |           19 |
| 2023 |    11 |           23 |
| 2023 |    12 |           22 |
| 2024 |     1 |           26 |
| 2024 |     2 |           18 |
| 2024 |     3 |           16 |
| 2024 |     4 |           24 |
| 2024 |     5 |           21 |
| 2024 |     6 |           27 |
| 2024 |     7 |           13 |
| 2024 |     8 |           26 |
| 2024 |     9 |           19 |
| 2024 |    10 |           15 |
| 2024 |    11 |           23 |
| 2024 |    12 |           17 |
+------+-------+--------------+ 
-- 24 rows in set (0.00 sec) */

-- 3. Use SUM() for revenue

SELECT YEAR(order_date) AS year, MONTH(order_date) AS month, SUM(amount) AS total_revenue FROM orders_online GROUP BY year, month ORDER BY year, month;

/* +------+-------+---------------+
| year | month | total_revenue |
+------+-------+---------------+
| 2023 |     1 |       8056.73 |
| 2023 |     2 |      11553.14 |
| 2023 |     3 |      11374.26 |
| 2023 |     4 |      12736.95 |
| 2023 |     5 |       8073.93 |
| 2023 |     6 |       7831.07 |
| 2023 |     7 |      10819.29 |
| 2023 |     8 |      12379.33 |
| 2023 |     9 |       9306.86 |
| 2023 |    10 |       9188.59 |
| 2023 |    11 |       8746.10 |
| 2023 |    12 |      12795.72 |
| 2024 |     1 |      13415.15 |
| 2024 |     2 |       9808.79 |
| 2024 |     3 |       7728.64 |
| 2024 |     4 |      11235.02 |
| 2024 |     5 |       7875.89 |
| 2024 |     6 |      14474.60 |
| 2024 |     7 |       7514.65 |
| 2024 |     8 |      13644.39 |
| 2024 |     9 |       8922.63 |
| 2024 |    10 |       9049.62 |
| 2024 |    11 |       9594.25 |
| 2024 |    12 |       8108.27 |
+------+-------+---------------+
24 rows in set (0.00 sec) */

-- 4. COUNT(DISTINCT order_id) for volume

SELECT YEAR(order_date) AS year, MONTH(order_date) AS month, COUNT(DISTINCT order_id) AS order_volume FROM orders_online GROUP BY year, month ORDER BY year, month;

/* +------+-------+--------------+
| year | month | order_volume |
+------+-------+--------------+
| 2023 |     1 |           17 |
| 2023 |     2 |           23 |
| 2023 |     3 |           27 |
| 2023 |     4 |           25 |
| 2023 |     5 |           21 |
| 2023 |     6 |           14 |
| 2023 |     7 |           20 |
| 2023 |     8 |           23 |
| 2023 |     9 |           21 |
| 2023 |    10 |           19 |
| 2023 |    11 |           23 |
| 2023 |    12 |           22 |
| 2024 |     1 |           26 |
| 2024 |     2 |           18 |
| 2024 |     3 |           16 |
| 2024 |     4 |           24 |
| 2024 |     5 |           21 |
| 2024 |     6 |           27 |
| 2024 |     7 |           13 |
| 2024 |     8 |           26 |
| 2024 |     9 |           19 |
| 2024 |    10 |           15 |
| 2024 |    11 |           23 |
| 2024 |    12 |           17 |
+------+-------+--------------+
24 rows in set (0.00 sec) */

-- 5. ORDER BY for sorting

SELECT YEAR(order_date) AS year, MONTH(order_date) AS month, SUM(amount) AS total_revenue, COUNT(DISTINCT order_id) AS order_volume FROM orders_online
GROUP BY year, month ORDER BY year ASC, month ASC;

/* +------+-------+---------------+--------------+
| year | month | total_revenue | order_volume |
+------+-------+---------------+--------------+
| 2023 |     1 |       8056.73 |           17 |
| 2023 |     2 |      11553.14 |           23 |
| 2023 |     3 |      11374.26 |           27 |
| 2023 |     4 |      12736.95 |           25 |
| 2023 |     5 |       8073.93 |           21 |
| 2023 |     6 |       7831.07 |           14 |
| 2023 |     7 |      10819.29 |           20 |
| 2023 |     8 |      12379.33 |           23 |
| 2023 |     9 |       9306.86 |           21 |
| 2023 |    10 |       9188.59 |           19 |
| 2023 |    11 |       8746.10 |           23 |
| 2023 |    12 |      12795.72 |           22 |
| 2024 |     1 |      13415.15 |           26 |
| 2024 |     2 |       9808.79 |           18 |
| 2024 |     3 |       7728.64 |           16 |
| 2024 |     4 |      11235.02 |           24 |
| 2024 |     5 |       7875.89 |           21 |
| 2024 |     6 |      14474.60 |           27 |
| 2024 |     7 |       7514.65 |           13 |
| 2024 |     8 |      13644.39 |           26 |
| 2024 |     9 |       8922.63 |           19 |
| 2024 |    10 |       9049.62 |           15 |
| 2024 |    11 |       9594.25 |           23 |
| 2024 |    12 |       8108.27 |           17 |
+------+-------+---------------+--------------+
24 rows in set (0.00 sec) */

-- 6. Limit results for a specific time period

SELECT YEAR(order_date) AS year, MONTH(order_date) AS month, SUM(amount) AS total_revenue,COUNT(DISTINCT order_id) AS order_volume FROM orders_online
WHERE YEAR(order_date) = 2024 GROUP BY year, month ORDER BY month ASC;

/* +------+-------+---------------+--------------+
| year | month | total_revenue | order_volume |
+------+-------+---------------+--------------+
| 2024 |     1 |      13415.15 |           26 |
| 2024 |     2 |       9808.79 |           18 |
| 2024 |     3 |       7728.64 |           16 |
| 2024 |     4 |      11235.02 |           24 |
| 2024 |     5 |       7875.89 |           21 |
| 2024 |     6 |      14474.60 |           27 |
| 2024 |     7 |       7514.65 |           13 |
| 2024 |     8 |      13644.39 |           26 |
| 2024 |     9 |       8922.63 |           19 |
| 2024 |    10 |       9049.62 |           15 |
| 2024 |    11 |       9594.25 |           23 |
| 2024 |    12 |       8108.27 |           17 |
+------+-------+---------------+--------------+
12 rows in set (0.00 sec) */